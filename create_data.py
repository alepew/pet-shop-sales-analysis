import pandas as pd
import numpy as np
from datetime import datetime, timedelta

np.random.seed(42)

tovary = [
    'Корм для кошек (сухой)',
    'Корм для кошек (влажный)', 
    'Корм для собак (сухой)',
    'Корм для собак (влажный)',
    'Наполнитель для туалета',
    'Когтеточка',
    'Игрушка для кошек',
    'Игрушка для собак',
    'Лежанка для кошек',
    'Лежанка для собак',
    'Миска керамическая',
    'Миска пластиковая',
    'Поводок/ошейник',
    'Клетка/переноска',
    'Шампунь для животных',
    'Расческа/пуходерка',
    'Лакомства для кошек',
    'Лакомства для собак',
    'Витамины/добавки',
    'Зубная паста для животных'
]

kategorii = {
    'Корм для кошек (сухой)': 'Корма',
    'Корм для кошек (влажный)': 'Корма',
    'Корм для собак (сухой)': 'Корма',
    'Корм для собак (влажный)': 'Корма',
    'Лакомства для кошек': 'Лакомства',
    'Лакомства для собак': 'Лакомства',
    'Наполнитель для туалета': 'Гигиена',
    'Шампунь для животных': 'Гигиена',
    'Зубная паста для животных': 'Гигиена',
    'Витамины/добавки': 'Здоровье',
    'Игрушка для кошек': 'Игрушки',
    'Игрушка для собак': 'Игрушки',
    'Когтеточка': 'Игрушки',
    'Лежанка для кошек': 'Мебель/лежанки',
    'Лежанка для собак': 'Мебель/лежанки',
    'Миска керамическая': 'Посуда',
    'Миска пластиковая': 'Посуда',
    'Поводок/ошейник': 'Амуниция',
    'Клетка/переноска': 'Амуниция',
    'Расческа/пуходерка': 'Груминг'
}

ceny = {
    'Корм для кошек (сухой)': 1200,
    'Корм для кошек (влажный)': 350,
    'Корм для собак (сухой)': 2500,
    'Корм для собак (влажный)': 450,
    'Наполнитель для туалета': 800,
    'Когтеточка': 1500,
    'Игрушка для кошек': 250,
    'Игрушка для собак': 350,
    'Лежанка для кошек': 1800,
    'Лежанка для собак': 2500,
    'Миска керамическая': 400,
    'Миска пластиковая': 150,
    'Поводок/ошейник': 600,
    'Клетка/переноска': 2000,
    'Шампунь для животных': 450,
    'Расческа/пуходерка': 500,
    'Лакомства для кошек': 200,
    'Лакомства для собак': 250,
    'Витамины/добавки': 900,
    'Зубная паста для животных': 350
}

dates = []
products = []
quantities = []
prices = []

for i in range(1000):
    days_ago = np.random.randint(0, 90)
    date = (datetime.now() - timedelta(days=days_ago)).strftime('%Y-%m-%d')
    dates.append(date)
    
    product = np.random.choice(tovary)
    products.append(product)
    
    base_price = ceny[product]
    price = base_price * (1 + np.random.uniform(-0.15, 0.15))
    prices.append(round(price, -1))
    
    if 'Корм' in product or 'Наполнитель' in product:
        quantities.append(np.random.randint(1, 5))
    elif 'Лежанка' in product or 'Клетка' in product:
        quantities.append(np.random.randint(1, 2))
    else:
        quantities.append(np.random.randint(1, 4))

df = pd.DataFrame({
    'date': dates,
    'product': products,
    'category': [kategorii[p] for p in products],
    'price': prices,
    'quantity': quantities
})

df['total'] = df['price'] * df['quantity']

df.loc[15, 'price'] = None
df.loc[42, 'quantity'] = None

df.to_csv('pet_shop_sales.csv', index=False)
print("Данные зоомагазина созданы!")
print(f"Всего продаж: {len(df)}")
print(f"Товаров: {df['product'].nunique()}")
print(f"Категорий: {df['category'].nunique()}")